{% extends "base.html" %}
{% block content %}
<div class="bg-white p-6 rounded-lg shadow-md max-w-md mx-auto">
    <h2 class="text-xl font-semibold mb-4">2FA Setup</h2>
    <form method="POST" class="space-y-4">
        {{ form.hidden_tag() }}
        <div>
            <label class="block text-sm font-medium text-gray-700">
                {{ form.enable_2fa }}
                {{ form.enable_2fa.label }}
            </label>
            {% if form.enable_2fa.errors %}
                <p class="text-red-500 text-sm">{{ form.enable_2fa.errors[0] }}</p>
            {% endif %}
        </div>
        {% if qr_code %}
            <p class="mb-4">Scan the QR code below with your authenticator app (e.g., Google Authenticator) or enter the secret manually:</p>
            <img src="data:image/png;base64,{{ qr_code }}" alt="2FA QR Code" class="mb-4">
            <p class="mb-4"><strong>Secret:</strong> {{ totp_secret }}</p>
            <p class="text-sm text-gray-600">Save this secret securely. Youâ€™ll need to enter a 6-digit code from your authenticator app when logging in.</p>
        {% elif totp_secret %}
            <p class="mb-4">2FA is enabled. Disable it using the checkbox above.</p>
        {% else %}
            <p class="mb-4">2FA is disabled. Enable it to generate a QR code for your authenticator app.</p>
        {% endif %}
        {{ form.submit(class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 w-full") }}
    </form>
    <a href="{{ url_for('index', page='dashboard') }}" class="block text-center mt-4 text-blue-500 hover:underline">Back to Dashboard</a>
</div>
{% endblock %}
